<?xml version="1.0" encoding="UTF-8"?>
<bfm namespace="VendingMachineModel">
    <feature name="VendingMachine">
        <events>
            <event id="change" fexpression="!FreeDrinks"> </event>
            <event id="take_1" fexpression="!FreeDrinks"> </event>
            <event id="open" fexpression="!FreeDrinks"> </event>
            <event id="pay" fexpression="!FreeDrinks"> </event>
            <event id="close" fexpression="!FreeDrinks"> </event>
        </events>
        <mandatory>
            <feature name="Beverages">
                <or>
                    <feature name="Soda">
                        <events>
                            <event id="serveSoda" fexpression="Soda"> </event>
                            <event id="soda" fexpression="Soda"> </event>
                        </events>
                        <event_constraints>
                            <causalities>
                                <causality target="serveSoda">
                                    <bundle>
                                        <event id="soda"> </event>
                                    </bundle>
                                </causality>
                            </causalities>
                        </event_constraints>
                    </feature>
                    <feature name="Tea">
                        <events>
                            <event id="tea" fexpression="Tea"> </event>
                            <event id="serveTea" fexpression="Tea"> </event>
                        </events>
                        <event_constraints>
                            <causalities>
                                <causality target="serveTea">
                                    <bundle>
                                        <event id="tea"> </event>
                                    </bundle>
                                </causality>
                            </causalities>
                        </event_constraints>
                    </feature>
                </or>
                <event_constraints>
                    <conflicts>
                        <conflict>
                            <events>
                                <event id="serveSoda"> </event>
                                <event id="soda"> </event>
                            </events>
                            <events>
                                <event id="tea"> </event>
                                <event id="serveTea"> </event>
                            </events>
                        </conflict>
                    </conflicts>
                </event_constraints>
            </feature>
        </mandatory>
        <mandatory>
            <feature name="Currency">
                <alternative>
                    <feature name="Euro"></feature>
                    <feature name="Dollar"></feature>
                </alternative>
            </feature>
        </mandatory>
        <optional>
            <feature name="FreeDrinks">
                <events>
                    <event id="take_0" fexpression="FreeDrinks"> </event>
                    <event id="free" fexpression="FreeDrinks"> </event>
                </events>
            </feature>
        </optional>
        <optional>
            <feature name="CancelPurchase">
                <events>
                    <event id="cancel" fexpression="CancelPurchase"> </event>
                    <event id="return" fexpression="CancelPurchase"> </event>
                </events>
                <event_constraints>
                    <causalities>
                        <causality target="return">
                            <bundle>
                                <event id="cancel"> </event>
                            </bundle>
                        </causality>
                    </causalities>
                </event_constraints>
            </feature>
        </optional>
        <event_constraints>
            <causalities>
                <causality target="take_0">
                    <bundle>
                        <event id="serveSoda"> </event>
                        <event id="serveTea"> </event>
                    </bundle>
                </causality>
                <causality target="soda">
                    <bundle>
                        <event id="change"> </event>
                        <event id="free"> </event>
                    </bundle>
                </causality>
                <causality target="close">
                    <bundle>
                        <event id="take_1"> </event>
                    </bundle>
                </causality>
                <causality target="take_1">
                    <bundle>
                        <event id="open"> </event>
                    </bundle>
                </causality>
                <causality target="change">
                    <bundle>
                        <event id="pay"> </event>
                    </bundle>
                </causality>
                <causality target="open">
                    <bundle>
                        <event id="serveSoda"> </event>
                        <event id="serveTea"> </event>
                    </bundle>
                </causality>
                <causality target="tea">
                    <bundle>
                        <event id="change"> </event>
                        <event id="free"> </event>
                    </bundle>
                </causality>
                <causality target="cancel">
                    <bundle>
                        <event id="change"> </event>
                        <event id="free"> </event>
                    </bundle>
                </causality>
            </causalities>
            <conflicts>
                <conflict>
                    <events>
                        <event id="take_0"> </event>
                        <event id="cancel"> </event>
                        <event id="return"> </event>
                    </events>
                    <events>
                        <event id="take_1"> </event>
                        <event id="open"> </event>
                        <event id="close"> </event>
                    </events>
                </conflict>
                <conflict>
                    <events>
                        <event id="take_0"> </event>
                        <event id="free"> </event>
                    </events>
                    <events>
                        <event id="pay"> </event>
                    </events>
                </conflict>
                <conflict>
                    <events>
                        <event id="cancel"> </event>
                        <event id="return"> </event>
                    </events>
                    <events>
                        <event id="take_0"> </event>
                        <event id="tea"> </event>
                        <event id="serveSoda"> </event>
                        <event id="take_1"> </event>
                        <event id="serveTea"> </event>
                        <event id="soda"> </event>
                        <event id="open"> </event>
                        <event id="close"> </event>
                    </events>
                </conflict>
                <conflict>
                    <events>
                        <event id="change"> </event>
                        <event id="pay"> </event>
                    </events>
                    <events>
                        <event id="free"> </event>
                    </events>
                </conflict>
            </conflicts>
        </event_constraints>
    </feature>
</bfm>